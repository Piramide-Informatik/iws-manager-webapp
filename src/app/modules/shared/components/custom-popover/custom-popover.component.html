<div class="app-custom-popover-container">
    <p-popover #op>
        <ng-container [ngSwitch]="type">

            <!-- TYPE: LIST -->
            <ng-container *ngSwitchCase="'list'">
                <div class="popover-content">
                    <!-- Header with translation JUST of static text -->
                    <div class="popover-header" *ngIf="values.length > 0">
                        <h3>{{ 'CUSTOM_POPOVER.TITLE.SELECT' | translate }}</h3>
                    </div>

                    <!-- List of items -->
                    <div class="popover-list" *ngIf="values.length > 0">
                        <div *ngFor="let item of values; let i = index" class="popover-item"
                            [ngStyle]="{'backgroundColor': getItemBackgroundColor(i)}" (click)="onSelect(item)"
                            (keydown.enter)="onSelect(item)">

                            <!-- Main content (values WITHOUT translation) -->
                            <div class="item-fields-container">
                                <ng-container *ngFor="let field of displayFields; let fieldIndex = index">

                                    <!-- Field as badge -->
                                    <span *ngIf="shouldShowAsBadge(field)" class="badge" [ngStyle]="getBadgeStyles(i)">
                                        {{ getFieldValue(item, field) }} <!-- WITHOUT translation -->
                                    </span>

                                    <!-- Field as text -->
                                    <span *ngIf="!shouldShowAsBadge(field)" class="text-field">
                                        {{ getFieldValue(item, field) }} <!-- WITHOUT translation -->
                                    </span>

                                    <!-- Separator (except the last one) -->
                                    <span *ngIf="shouldShowSeparator(fieldIndex)" class="separator">â€¢</span>
                                </ng-container>
                            </div>

                            <!-- Visual indicator for holidays (with translation JUST of static text) -->
                            <div *ngIf="isHoliday(item)" class="holiday-indicator">
                                <i class="pi pi-sun"></i>
                                <span>{{ 'CUSTOM_POPOVER.INDICATOR.HOLIDAY' | translate }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Footer with translation JUST of static text -->
                    <div class="popover-footer" [ngClass]="{ 'delete' : values.length === 0 }">
                        <button *ngIf="showButtonDelete" pButton [label]="'BUTTONS.DELETE' | translate" icon="pi pi-trash"
                            class="p-button-text p-button-sm btn-delete" (click)="onSelect(null)"></button>
                        <button pButton [label]="'BUTTONS.CANCEL' | translate" icon="pi pi-times"
                            class="p-button-text p-button-sm" (click)="op.hide()"></button>
                    </div>
                </div>
            </ng-container>

            <!-- DEFAULT (with translation JUST of static text) -->
            <ng-container *ngSwitchDefault>
                <div class="popover-default">
                    <div class="default-icon">
                        <i class="pi pi-inbox"></i>
                    </div>
                    <span>{{ 'CUSTOM_POPOVER.MESSAGE.NO_OPTIONS' | translate }}</span>
                </div>
            </ng-container>

        </ng-container>
    </p-popover>
</div>